{"version":3,"file":"app.min.js","sources":["app.ts"],"sourcesContent":["/**\n * EGroupware Schulmanager\n *\n * @link http://www.egroupware.org\n * @package schulmanager\n * @author Axel Wild <info-AT-wild-solutions.de>\n * @copyright (c) 2022 by info-AT-wild-solutions.de\n * @license http://opensource.org/licenses/gpl-license.php GPL - GNU General Public License\n */\n\n//import {EgwApp} from '../../api/js/jsapi/egw_app';\n\nimport {etemplate2} from \"../../api/js/etemplate/etemplate2\";\nimport {et2_nextmatch} from \"../../api/js/etemplate/et2_extension_nextmatch\";\nimport {et2_dialog} from \"../../api/js/etemplate/et2_widget_dialog\";\n\nexport class SchulmanagerApp extends EgwApp\n{\n\treadonly appname = 'schulmanager';\n\n\tconstructor()\n\t{\n\t\tsuper('schulmanager');\n\t}\n\n\t/**\n\t * This function is called when the etemplate2 object is loaded\n\t * and ready.  If you must store a reference to the et2 object,\n\t * make sure to clean it up in destroy().\n\t *\n\t * @param et2 etemplate2 Newly ready object\n\t * @param string name\n\t */\n\tet2_ready(et2, name: string)\n\t{\n\t\t// call parent\n\t\tsuper.et2_ready(et2, name);\n\n\t\tif (name == 'schulmanager.notenmanager.index') {\n            this.header_change();\n\t\t}\n\t\tif (name == 'schulmanager.notenmanager.edit') {\n            this.header_change();\n        }\n\t\tif (name == 'schulmanager.calendar.index') {\n\t\t\tthis.cal_header_change();\n\t\t\tthis.cal_hide_items();\t\t\t\n        }\n\t\tif (name == 'schulmanager.notenmanager.notendetails') {\n\t\t\tthis.header_change();\n\t\t}\n\t\tif (name == 'schulmanager.schuelerview') {\n\t\t\tthis.onSchuelerViewKlasseChanged();\n\t\t}\n\t}\n\n\n\t/**\n\t * laden der gewichtungen beim ersten Laden des Templates\n\t * @param {type} _action\n\t * @returns {undefined}\n\t */\n\theader_change()\n\t{\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_getGewichtungen';\n\t\tlet query = '';\n\t\tthis.egw.json(func, [query], function (totals) {\n\t\t\tfor (let key in totals){\n\t\t\t\tlet widget = et2.getWidgetById(key);\n\t\t\t\tif(widget){\n\t\t\t\t\twidget.set_value(totals[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\t// export notenbuch\n\texportpdf_nb(_id, _widget)\n\t{\n\t\tthis.egw.loading_prompt('schulmanager',true, this.egw.lang('please wait...'));\n\t\tlet $a = jQuery(document.createElement('a')).appendTo('body').hide();\n\t\tlet url = window.egw.webserverUrl+'/index.php?menuaction=schulmanager.schulmanager_download_ui.exportpdf_nb';\n\t\t$a.prop('href',url);\n\t\t$a.prop('download','');\n\t\t$a[0].click();\n\t\t$a.remove();\n\t\tthis.egw.loading_prompt('schulmanager',false);\n\t}\n\n\n\t/**\n\t * download all grades in all subjects of all students as pdf\n\t * @param {type} _id\n\t * @param {type} _widget\n\t * @returns {undefined}\n\t */\n\texportpdf_kv(_id, _widget){\n\t\tlet id = _widget.id;\n\t\tlet params = 'mode=stud';\n\n\t\tif(id == \"button[pdfexportteacherzz]\"){\n\t\t\tparams = 'mode=teacher_zz';\n\t\t}\n\t\telse if(id == \"button[pdfexportteacherjz]\"){\n\t\t\tparams = 'mode=teacher_jz';\n\t\t}\n\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-klassenview_showexportmodal\");\n\t\tmodal.style.display = \"none\";\n\n\t\tthis.egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\n\t\tlet $a = jQuery(document.createElement('a')).appendTo('body').hide();\n\t\tlet url = window.egw.webserverUrl+'/index.php?menuaction=schulmanager.schulmanager_download_ui.exportpdf_kv&'+params;\n\t\t$a.prop('href',url);\n\t\t$a.prop('download','');\n\t\t$a[0].click();\n\t\t$a.remove();\n\n\t\tegw.loading_prompt('schulmanager',false);\n\t}\n\n\t/**\n\t * reload klassleiter before pdf export\n\t * @param _id\n\t * @param _widget\n\t */\n\texportpdf_nbericht_prepare(_id, _widget){\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-klassenview_showexportmodal\");\n\t\tmodal.style.display = \"block\";\n\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_nbericht_prepare';\n\n\t\tthis.egw.json(func, [], function (result) {\n\t\t\tlet widget = <HTMLSelectElement> document.getElementById('schulmanager-notenmanager-klassenview_klassleiter');\n\n\t\t\tif(widget){\n\t\t\t\tlet length = widget.options.length;\n\t\t\t\tfor (let i = length-1; i >= 0; i--) {\n\t\t\t\t\twidget.options[i] = null;\n\t\t\t\t}\n\t\t\t\tfor (let key in result['klassleiter']){\n\t\t\t\t\tlet opt = document.createElement(\"option\");\n\t\t\t\t\topt.value = key;\n\t\t\t\t\topt.text = result['klassleiter'][key];\n\t\t\t\t\twidget.options.add(opt);\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * download all grades in all subjects of all students as pdf handout for students\n\t * @param {type} _id\n\t * @param {type} _widget\n\t * @returns {undefined}\n\t */\n\texportpdf_nbericht(_id, _widget){\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-klassenview_showexportmodal\");\n\t\tmodal.style.display = \"none\";\n\t\tthis.egw.loading_prompt('schulmanager',true, this.egw.lang('please wait...'));\n\t\tlet showReturn = document.getElementById('schulmanager-notenmanager-klassenview_add_return_block').checked;\n\t\tlet showSigned = document.getElementById('schulmanager-notenmanager-klassenview_add_signed_block').checked;\n\t\tlet signerWidget = <HTMLSelectElement> document.getElementById('schulmanager-notenmanager-klassenview_klassleiter');\n\t\tlet signerid = signerWidget.value;\n\t\tlet $a = jQuery(document.createElement('a')).appendTo('body').hide();\n\t\tlet url = window.egw.webserverUrl+'/index.php?menuaction=schulmanager.schulmanager_download_ui.exportpdf_nbericht&showReturnInfo='+showReturn+'&signed='+showSigned+'&signerid='+signerid;\n\t\t$a.prop('href',url);\n\t\t$a.prop('download','');\n\t\t$a[0].click();\n\t\t$a.remove();\n\t\tthis.egw.loading_prompt('schulmanager',false);\n\t}\n\n\t/**\n\t * export notenbuch\n\t * @param _id\n\t * @param _widget\n\t */\n\texportpdf_calm(_id, _widget)\n\t{\n\t\tlet egw = this.egw;\n        egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\t\tlet $a = jQuery(document.createElement('a')).appendTo('body').hide();\n\t\tlet url = window.egw.webserverUrl+'/index.php?menuaction=schulmanager.schulmanager_download_ui.exportpdf_calm';\n\t\t$a.prop('href',url);\n\t\t$a.prop('download','');\n\t\t$a[0].click();\n\t\t$a.remove();\n\t\tthis.egw.loading_prompt('schulmanager',false);\n\t}\n\n\n\t/**\n\t * laden der weekdays\n\t * @param {type} _action\n\t * @returns {undefined}\n\t */\n\tcal_header_change()\n\t{\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_cal_ui.ajax_getWeekdays';\n\n\t\tlet query = '';\n\t\tthis.egw.json(func, [query], function (result) {\n\t\t\tfor (let key in result['nm_header']){\n\t\t\t\tlet widget = et2.getWidgetById(key);\n\t\t\t\tif(widget){\n\t\t\t\t\twidget.getDOMNode().childNodes[0].innerHTML = result['nm_header'][key]['nr'];\n\t\t\t\t\twidget.getDOMNode().childNodes[1].innerHTML = result['nm_header'][key]['name'];\n\t\t\t\t\twidget.parentNode.parentNode.classList.remove('sm_cal_saso');\n\t\t\t\t\twidget.parentNode.parentNode.classList.remove('sm_cal_mofr');\n\t\t\t\t\twidget.parentNode.parentNode.classList.add(result['nm_header'][key]['class']);\n\n\t\t\t\t\tif (result['nm_header'][key]['class'] == 'sm_cal_saso' && widget.getDOMNode().childNodes[2]) {\n                        widget.getDOMNode().childNodes[2].style.display = \"none\";\n                    }\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\tcal_hide_items()\n\t{\n\t\tegw.css(\".sm_cal_hidden\",\"display:none\");\n\t}\n\n\tcal_focus_item(_action, widget)\n\t{\n\t\t//alert(widget.getDOMNode());\n\t\tlet _send = function() {\n\t\t\tegw().json(\n\t\t\t\t'schulmanager.schulmanager_cal_ui.ajax_editCalEvent',\n\t\t\t\t[\n\t\t\t\t\twidget.id\n\t\t\t\t],\n\t\t\t\t// Remove loading spinner\n\t\t\t\tfunction(result) {\t\t\t\t\t\n\t\t\t\t\tjQuery(_action).blur();\n\t\t\t\t\t//alert(result['test']);\n\t\t\t\t}\n\t\t\t).sendRequest(true);\n\t\t};\n\t\t_send();\n\t}\n\n\tcalEditMultiple(_action, widget)\n\t{\n\t\t//alert(widget.id);\n\t\tlet _send = function() {\n\t\t\tegw().json(\n\t\t\t\t'schulmanager.schulmanager_cal_ui.ajax_editCalEvent',\n\t\t\t\t[\n\t\t\t\t\twidget.id,\n\t\t\t\t\ttrue\n\t\t\t\t],\n\t\t\t\t// Remove loading spinner\n\t\t\t\tfunction(result) {\n\t\t\t\t\tjQuery(_action).blur();\n\t\t\t\t\t//alert(result['test']);\n\t\t\t\t}\n\t\t\t).sendRequest(true);\n\t\t};\n\t\t_send();\n\t}\n\n\tcalDeleteEvent(_action, widget)\n\t{\n\t\t//alert(widget[0].id);\n\t\tlet _send = function() {\n\t\t\tegw().json(\n\t\t\t\t'schulmanager.schulmanager_cal_ui.ajax_deleteEvent',\n\t\t\t\t[\n\t\t\t\t\twidget[0].id\n\t\t\t\t],\n\t\t\t\t// Remove loading spinner\n\t\t\t\tfunction(result) {\n\t\t\t\t\tegw(window).refresh(result['msg'], 'schulmanager', 'schulmanager-calendar-editevent', 'update');\n\t\t\t\t\tvar nm = etemplate2.getById('schulmanager-calendar-editevent').widgetContainer.getWidgetById('nm');\n\t\t\t\t\tnm.refresh(null,'update');\n\t\t\t\t}\n\t\t\t).sendRequest(true);\n\t\t};\n\t\t_send();\n\t}\n\n\tadd_list_event(widget,prefix){\n\t\tlet et2 = this.et2;\n\t\tlet type_id = prefix.concat('sm_type_options_list');\n\t\tlet fach_id = prefix.concat('sm_fach_options_list');\n\t\tlet user_id = prefix.concat('sm_user_list');\n\n\t\tlet type = (<HTMLInputElement> document.getElementById(type_id)).value;\n\t\tlet fach = (<HTMLInputElement> document.getElementById(fach_id)).value;\n\t\tlet user = null;\n\n\t\tif(document.getElementById(user_id)){\n\t\t\tuser = (<HTMLInputElement> document.getElementById(user_id)).value;\n\t\t}\n\t\telse{\n\t\t\tuser_id = prefix.concat('sm_activeuserID');\n\t\t\tuser = (<HTMLInputElement> document.getElementById(user_id)).value;\n\t\t}\n\n\t\tlet _send = function() {\n\t\t\tegw().json(\n\t\t\t\t'schulmanager.schulmanager_cal_ui.ajax_addEventToList',\n\t\t\t\t[\n\t\t\t\t\ttype,\n\t\t\t\t\tfach,\n\t\t\t\t\tuser\n\t\t\t\t],\n\t\t\t\t// Remove loading spinner\n\t\t\t\tfunction(result : any) {\n\t\t\t\t\tegw(window).refresh(result['msg'], 'schulmanager', 'schulmanager-calendar-editevent', 'update');\n\t\t\t\t\tlet nm = etemplate2.getById('schulmanager-calendar-editevent').widgetContainer.getWidgetById('nm');\n\t\t\t\t\tnm.refresh(null,'update');\n\t\t\t\t}\n\t\t\t).sendRequest(true);\n\t\t};\n\t\t_send();\n\n\t}\n\n\tcalShowAddEvent(action, selected){\n\t\tjQuery('table.addnewevent').css('display','inline');\n\t}\n\n\tnmEditGew(_action, widget)\n\t{\n\t\tjQuery('table.editgew').css('display','inline');\n\t}\n\n\n\tchangeNote(action, _senders)\n\t{\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-edit_token');\n\t\tlet inputinfo_date = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-edit_date').firstChild;\n\t\tlet inputinfo_type = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-edit_notgebart');\n\t\tlet inputinfo_desc = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-edit_desc');\n\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_noteModified';\n\t\tlet noteKey = action.name;\n\t\tlet noteVal = action.value;\n\t\tlet token = tokenDiv.value;\n\n\t\tlet note_date = inputinfo_date.value;\n\t\tlet note_type = inputinfo_type.value;\n\t\tlet note_desc = inputinfo_desc.value;\n\n\t\tif(action.type == \"checkbox\"){\n\t\t\tif(action.checked){\n\t\t\t\tnoteVal = 1;\n\t\t\t}else{\n\t\t\t\tnoteVal = 0;\n\t\t\t}\n\t\t}\n\t\tthis.egw.json(func, [noteKey, noteVal, token, note_date, note_type, note_desc], function (result) {\n\t\t\tjQuery(action).addClass('schulmanager_note_changed');\n\t\t\tfor (let key in result){\n\t\t\t\tif(key == 'error_msg'){\n\t\t\t\t\talert(\"Error:\\n\\t\"+result[key]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tlet cssAvgKey = 'schulmanager-notenmanager-edit_'+key+'[-1][note]';\n\t\t\t\tlet widget = <HTMLInputElement> document.getElementById(cssAvgKey);\n\t\t\t\tif(widget){\n\t\t\t\t\twidget.value = result[key]['[-1][note]'];\n\t\t\t\t\tif(action.id == cssAvgKey){\n\t\t\t\t\t\t// reset css class if this input value has been modified\n\t\t\t\t\t\tjQuery(action).removeClass('nm_avg_manuell');\n\t\t\t\t\t\tjQuery(action).removeClass('nm_avg_auto');\n\t\t\t\t\t\tjQuery(action).addClass(result[key]['avgclass']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\n\t\n    changeGew(action, senders)\n\t{\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_gewModified';\n\t\tlet gewKey = action.name;\n\t\tlet gewVal = action.value;\n\n\t\tthis.egw.json(func, [gewKey, gewVal], function (result) {\n\t\t\tjQuery(action).addClass('schulmanager_note_changed');\n\t\t\tfor (let key in result){\n\t\t\t\tlet cssAvgKey = 'schulmanager-notenmanager-edit_'+key+'[-1][note]';\n\t\t\t\tlet widget = <HTMLInputElement> document.getElementById(cssAvgKey);\n\t\t\t\tif(widget){\n\t\t\t\t\twidget.value = result[key]['[-1][note]'];\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\tchangeGewAllModified(_action, _senders)\n\t{\n\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_gewAllModified';\n\t\tlet noteKey = _action.name;\n\t\tlet noteVal = _action.value;\n\t\tif(_action.type == \"checkbox\"){\n\t\t\tif(_action.checked){\n\t\t\t\tnoteVal = 1;\n\t\t\t}else{\n\t\t\t\tnoteVal = 0;\n\t\t\t}\n\t\t}\n\t\tthis.egw.json(func, [noteKey, noteVal], function (result) {\n\t\t\tjQuery(_action).addClass('schulmanager_note_changed');\n\t\t\tfor (let key in result){\n\t\t\t\tlet cssAvgKey = 'schulmanager-notenmanager-edit_'+key+'[-1][note]';\n\t\t\t\tlet cssAltBKey = 'schulmanager-notenmanager-edit_'+key+'[-1][checked]';\n\t\t\t\tlet widget = <HTMLInputElement> document.getElementById(cssAvgKey);\n\t\t\t\tlet widgetAltB = <HTMLInputElement> document.getElementById(cssAltBKey);\n\t\t\t\tif(widget){\n\t\t\t\t\twidget.value = result[key]['[-1][note]'];\n\t\t\t\t\tif(_action.id == cssAvgKey){\n\t\t\t\t\t\tjQuery(_action).removeClass('nm_avg_manuell');\n\t\t\t\t\t\tjQuery(_action).removeClass('nm_avg_auto');\n\t\t\t\t\t\tjQuery(_action).addClass(result[key]['avgclass']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(widgetAltB){\n\t\t\t\t\twidgetAltB.checked = result[key]['[-1][checked]'];\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\t\n\t/**\n\t * selectes teacher for a new substitution changed, reload list\n\t */\n\tsubs_TeacherChanged(_action, _senders)\n\t{\n\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_substitution_ui.ajax_getTeacherLessonList';\n\t\tlet teacher_id = _action.value;\n\t\t\n\t\tthis.egw.json(func, [teacher_id], function (result) {\n\t\t\tlet widget = <HTMLSelectElement> document.getElementById('schulmanager-substitution_add_lesson_list');\n\t\t\t\t\t\n\t\t\tif(widget){\n\t\t\t\tlet length = widget.options.length;\n\t\t\t\tfor (let i = length-1; i >= 0; i--) {\n\t\t\t\t\twidget.options[i] = null;\n\t\t\t\t}\n\t\t\t\tfor (let key in result){\n\t\t\t\t\tlet opt = document.createElement(\"option\");\n\t\t\t\t\topt.value = key;\n\t\t\t\t\topt.text = result[key];\n\t\t\t\t\twidget.options.add(opt);\n\t\t\t\t}\n\t\t\t}\t\t\t\t\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * AJAX loading student\n\t * @param _action\n\t * @param _senders\n\t */\n\tonDetailsNote(_action, _senders)\n\t{\n\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-index_showdetailsmodal\");\n\t\tmodal.style.display = \"block\";\n\n\t\tlet instance = this;\n\t\tlet stud_id = _senders[0]._index;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_getStudentDetails';\n\n\t\tthis.egw.json(func, [stud_id], function (result) {\n\t\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-index\");\n\t\t\tmodal.style.display = \"block\";\n\n\t\t\tfor (let key in result){\n\t\t\t\t// noten\n\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t\tinstance.updateDetailsNoten(key, result, 'schulmanager-notenmanager-index_');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlet widget_id = 'schulmanager-notenmanager-index_' + key;\n\t\t\t\t\tlet widget = <HTMLInputElement>document.getElementById(widget_id);\n\t\t\t\t\tif (widget) {\n\t\t\t\t\t\twidget.innerText = result[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tjQuery('#schulmanager-notenmanager-index_schulmanager-notenmanager-details').css('display','inline');\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * AJAX loading student\n\t * @param _action\n\t * @param _senders\n\t */\n\tonContactData(_action, _senders)\n\t{\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-index_showcontactmodal\");\n\t\tmodal.style.display = \"block\";\n\n\t\tlet instance = this;\n\t\tlet stud_id = _senders[0]._index;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_getStudentContact';\n\n\t\tthis.egw.json(func, [stud_id], function (result) {\n\t\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-index\");\n\t\t\tmodal.style.display = \"block\";\n\n\t\t\tinstance.tableUpdate(\"schulmanager-notenmanager-index_grid-sko\", result['sko_nm_rows']);\n\t\t\tinstance.tableUpdate(\"schulmanager-notenmanager-index_grid-san\", result['san_nm_rows']);\n\t\t\tdelete result['sko_nm_rows'];\n\t\t\tdelete result['san_nm_rows'];\n\n\t\t\tfor (let key in result){\n\t\t\t\tlet widget_id = 'schulmanager-notenmanager-index_' + key;\n\t\t\t\tlet widget = <HTMLInputElement>document.getElementById(widget_id);\n\t\t\t\tif (widget) {\n\t\t\t\t\twidget.innerText = result[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tjQuery('#schulmanager-notenmanager-index_schulmanager-contact').css('display','inline');\n\t\t}).sendRequest(true);\n\t}\n\n\n\n\n\t/**\n\t * select students for a new class changed, reload list\n\t */\n\tonDetailsKlasseChanged(_action, _senders)\n\t{\n\t\tlet instance = this;\n\t\tlet egw = this.egw;\n\t\tthis.egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_DetailsKlasseChanged';\n\t\tlet klasse_id = _action.value;\n\n\t\tthis.egw.json(func, [klasse_id], function (result) {\n\t\t\t// update schueler select\n\t\t\tlet widget = <HTMLSelectElement> document.getElementById('schulmanager-notenmanager-notendetails_select_schueler');\n\n\t\t\tif(widget){\n\t\t\t\tlet length = widget.options.length;\n\t\t\t\tfor (let i = length-1; i >= 0; i--) {\n\t\t\t\t\twidget.options[i] = null;\n\t\t\t\t}\n\t\t\t\tfor (let key in result['select_schueler']){\n\t\t\t\t\tlet opt = document.createElement(\"option\");\n\t\t\t\t\topt.value = key;\n\t\t\t\t\topt.text = result['select_schueler'][key];\n\t\t\t\t\twidget.options.add(opt);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdelete(result['select_schueler']);\n\n\t\t\tfor (let key in result){\n\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t\tinstance.updateDetailsNoten(key, result, 'schulmanager-notenmanager-notendetails_');\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tlet widgetItem = document.getElementById('schulmanager-notenmanager-notendetails_' + key);\n\t\t\t\t\tif (widgetItem) {\n\t\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tegw.loading_prompt('schulmanager',false);\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * selectes teacher for a new substitution changed, reload list\n\t */\n\tonDetailsSchuelerChanged(_action, _senders)\n\t{\n\t\tlet instance = this;\n\t\t//this.egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_DetailsSchuelerChanged';\n\t\tlet schueler_id = _action.value;\n\n\t\tthis.egw.json(func, [schueler_id], function (result) {\n\t\t\tfor (let key in result){\n\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t\tinstance.updateDetailsNoten(key, result, 'schulmanager-notenmanager-notendetails_');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlet widgetItem = document.getElementById('schulmanager-notenmanager-notendetails_' + key);\n\t\t\t\t\tif (widgetItem) {\n\t\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//alert(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//egw.loading_prompt('schulmanager',false);\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * updates noten table in details view\n\t * @param key\n\t * @param result\n\t */\n\tupdateDetailsNoten(key, result, id_prefix)\n\t{\n\t\tif(key == 'details_noten'){\n\t\t\tfor (let block in result[key]){\n\t\t\t\tfor(let sIndex in result[key][block]){\n\t\t\t\t\tlet index = parseInt(sIndex);\n\t\t\t\t\tif(index >= -1 && index <= 11){\n\t\t\t\t\t\tfor(let col in result[key][block][index]){\n\t\t\t\t\t\t\tlet widget_col_id = id_prefix+key+'['+block+']'+'['+index+']'+'['+col+']';\n\t\t\t\t\t\t\tlet widget_col = document.getElementById(widget_col_id);\n\t\t\t\t\t\t\tif(widget_col){\n\t\t\t\t\t\t\t\twidget_col.innerText = result[key][block][index][col];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/**\n\t * selectes teacher for a new substitution changed, reload list\n\t */\n\tonDetailsNotenEdit(_action, _senders)\n\t{\n\t\tlet idPostfix = _senders.id.substring(4)\n\t\tlet isGlnw = _senders.id.substring(5, 9) == 'glnw';\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\tmodal.style.display = \"block\";\n\n\t\tlet widgetNote = <HTMLLabelElement>document.getElementById('schulmanager-notenmanager-notendetails_details_noten' + idPostfix + '[note]');\n\t\tif(widgetNote) {\n\t\t\tlet note_input = <HTMLInputElement>document.getElementById('schulmanager-notenmanager-notendetails_edit_note');\n\t\t\tnote_input.value = widgetNote.innerText;\n\t\t}\n\n\t\t// select GLNW and KLNW\n\t\tlet widgetTypeGKlnw = <HTMLLabelElement>document.getElementById('schulmanager-notenmanager-notendetails_details_noten' + idPostfix + '[art]');\n\t\tif(widgetTypeGKlnw){\n\t\t\tlet selTypeGlnw = <HTMLSelectElement>document.getElementById('schulmanager-notenmanager-notendetails_notgebart_glnw');\n\t\t\tlet selTypeKlnw = <HTMLSelectElement>document.getElementById('schulmanager-notenmanager-notendetails_notgebart_klnw');\n\n\t\t\tif(isGlnw) {\n\t\t\t\tfor (let i = 0; i < selTypeGlnw.options.length; i++) {\n\t\t\t\t\tif (selTypeGlnw.options[i].innerText == widgetTypeGKlnw.innerText) {\n\t\t\t\t\t\tselTypeGlnw.options[i].selected = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tselTypeGlnw.style.display = \"block\";\n\t\t\t\tselTypeKlnw.options[0].selected = true;\n\t\t\t\tselTypeKlnw.style.display = \"none\";\n\n\t\t\t\t// update style\n\t\t\t\tjQuery(\".details-grid-edit tr:nth-child(even)\").css(\"background\", \"#fff9ba\");\n\t\t\t\tjQuery(\".details-grid-edit tr:nth-child(odd)\").css(\"background\", \"#fff47c\");\n\t\t\t\tjQuery(\".details-grid-edit td\").css(\"border\", \"1px solid #ffdd00\");\n\t\t\t\t// end update style\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (let i = 0; i < selTypeKlnw.options.length; i++) {\n\t\t\t\t\tif (selTypeKlnw.options[i].innerText == widgetTypeGKlnw.innerText) {\n\t\t\t\t\t\tselTypeKlnw.options[i].selected = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tselTypeGlnw.options[0].selected = true;\n\t\t\t\tselTypeGlnw.style.display = \"none\";\n\t\t\t\tselTypeKlnw.style.display = \"block\";\n\n\t\t\t\t// update style\n\t\t\t\tjQuery(\".details-grid-edit tr:nth-child(even)\").css(\"background\", \"#beeaac\");\n\t\t\t\tjQuery(\".details-grid-edit tr:nth-child(odd)\").css(\"background\", \"#a1e684\");\n\t\t\t\tjQuery(\".details-grid-edit td\").css(\"border\", \"1px solid #7ecc67\");\n\t\t\t\t// end update style\n\t\t\t}\n\t\t\tdocument.getElementById('schulmanager-notenmanager-notendetails_edit_type_flag').innerText = isGlnw ? \"glnw\" : \"klnw\";\n\t\t}\n\t\t// definition date\n\t\tlet widgetDefDate = <HTMLLabelElement>document.getElementById('schulmanager-notenmanager-notendetails_details_noten' + idPostfix + '[definition_date]');\n\t\tif(widgetDefDate){\n\t\t\tlet defDate_input = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_date').firstChild;\n\t\t\tdefDate_input.value = widgetDefDate.innerText;\n\t\t}\n\t\t// description\n\t\tlet widgetDesc = <HTMLLabelElement>document.getElementById('schulmanager-notenmanager-notendetails_details_noten' + idPostfix + '[description]');\n\t\tif(widgetDesc){\n\t\t\tlet desc_input = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_desc');\n\t\t\tdesc_input.value = widgetDesc.innerText;\n\t\t}\n\n\t\t// note kaay\n\t\tlet note_key = <HTMLInputElement>document.getElementById('schulmanager-notenmanager-notendetails_edit_note_key');\n\t\tnote_key.value = idPostfix;\n\t}\n\n\t/**\n\t * Commits edited noten value\n\t * @param _action\n\t * @param _senders\n\t */\n\tonDetailsNotenCommit(_action, _senders)\n\t{\n\t\tlet egw = this.egw;\n\t\tlet instance = this;\n\t\tthis.egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\t\t// read data\n\t\tlet noteElement = <HTMLInputElement>document.getElementById('schulmanager-notenmanager-notendetails_edit_note');\n\t\tlet noteVal = noteElement.value;\n\n\t\tlet typeFlagElement = document.getElementById('schulmanager-notenmanager-notendetails_edit_type_flag');\n\t\tlet typeFlag = typeFlagElement.innerText;\n\n\t\tlet note_type = 0;\n\n\t\tif(typeFlag == \"glnw\"){\n\t\t\tlet selTypeGlnw = <HTMLSelectElement>document.getElementById('schulmanager-notenmanager-notendetails_notgebart_glnw');\n\t\t\tnote_type = selTypeGlnw.selectedIndex;\n\n\t\t}\n\t\telse if(typeFlag == \"klnw\"){\n\t\t\tlet selTypeKlnw = <HTMLSelectElement>document.getElementById('schulmanager-notenmanager-notendetails_notgebart_klnw');\n\t\t\tnote_type = selTypeKlnw.selectedIndex;\n\t\t}\n\n\t\tlet dateElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_date').firstChild;\n\t\tlet note_date = dateElement.value;\n\n\t\tlet descElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_desc');\n\t\tlet note_desc = descElement.value;\n\n\t\tlet tokenElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_token');\n\t\tlet token = tokenElement.value;\n\n\t\tlet noteKeyElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_note_key');\n\t\tlet noteKey = noteKeyElement.value\n\n\t\t// send data\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_noteDetailsModified';\n\n\t\tthis.egw.json(func, [noteKey, noteVal, token, note_date, note_type, note_desc, typeFlag], function (result) {\n\t\t\t//alert(\"done\");\n\t\t\tfor (let key in result){\n\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t\tinstance.updateDetailsNoten(key, result, 'schulmanager-notenmanager-notendetails_');\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tlet widgetItem = document.getElementById('schulmanager-notenmanager-notendetails_' + key);\n\t\t\t\t\tif (widgetItem) {\n\t\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//alert(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tegw.loading_prompt('schulmanager',false);\n\t\t}).sendRequest(true);\n\n\t\t// hide div\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\tmodal.style.display = \"none\";\n\t}\n\n\tonDetailsNotenCancel(_action, _senders)\n\t{\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\tmodal.style.display = \"none\";\n\t}\n\n\t/**\n\t * Delete single\n\t * @param _action\n\t * @param _senders\n\t */\n\tonDetailsNotenDelete(_action, _senders)\n\t{\n\t\tlet instance = this;\n\t\tlet egw = this.egw;\n\n\t\tlet tokenElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_token');\n\t\tlet token = tokenElement.value;\n\n\t\tlet noteKeyElement = <HTMLInputElement> document.getElementById('schulmanager-notenmanager-notendetails_edit_note_key');\n\t\tlet noteKey = noteKeyElement.value\n\t\t//var modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\t//modal.style.display = \"none\";\n\n\t\tlet action_id = _action.id;\n\t\tet2_dialog.show_dialog(function(button_id,value)\n\t\t{\n\t\t\tif (button_id != et2_dialog.NO_BUTTON)\n\t\t\t{\n\t\t\t\tlet func = 'schulmanager.schulmanager_ui.ajax_noteDetailsDeleted';\n\n\t\t\t\tegw.json(func, [noteKey, token], function (result) {\n\t\t\t\t\tfor (let key in result){\n\t\t\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t\t\t\tinstance.updateDetailsNoten(key, result, 'schulmanager-notenmanager-notendetails_');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tlet widgetItem = document.getElementById('schulmanager-notenmanager-notendetails_' + key);\n\t\t\t\t\t\t\tif (widgetItem) {\n\t\t\t\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}).sendRequest(true);\n\t\t\t}\n\n\t\t}, egw.lang('Confirmation required'), egw.lang('Confirmation required'), {}, et2_dialog.BUTTONS_OK_CANCEL, et2_dialog.QUESTION_MESSAGE);\n\n\t\tlet modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\tmodal.style.display = \"none\";\n\t}\n\n\t/**\n\t * select students for a new class changed, reload list\n\t */\n\tonSchuelerViewKlasseChanged(_action = null, _senders = null)\n\t{\n\t\tlet instance = this;\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_schuelerViewKlasseChanged';\n\t\tlet klasse_id = 0;\n\n\t\tif(_action !== null){\n\t\t\tklasse_id = _action.value;\n\t\t}\n\n\t\tthis.egw.json(func, [klasse_id], function (result) {\n\t\t\t/*\n\t\t\tvar sla_nm = <et2_nextmatch>et2.getWidgetById('sla_nm');\n\t\t\tvar sko_nm = <et2_nextmatch>et2.getWidgetById('sko_nm');\n\t\t\tsla_nm.applyFilters();\n\t\t\tsko_nm.applyFilters();\n\t\t\t*/\n\t\t\tlet not_nm = <et2_nextmatch>et2.getWidgetById('not_nm');\n\t\t\tnot_nm.applyFilters();\n\n\t\t\t// ############### new version\n\t\t\t//instance.tableUpdate(\"schulmanager-schuelerview_grid-sla\", result['sla_nm_rows']);\n\t\t\t//instance.tableUpdate(\"schulmanager-schuelerview_grid-sko\", result['sko_nm_rows']);\n\t\t\t//instance.tableUpdate(\"schulmanager-schuelerview_grid-san\", result['san_nm_rows']);\n\t\t\t// ##############################\n\n\t\t\t// update schueler select\n\t\t\tlet widget = <HTMLSelectElement> document.getElementById('schulmanager-schuelerview_select_schueler');\n\t\t\tif(widget){\n\t\t\t\tlet length = widget.options.length;\n\t\t\t\tfor (let i = length-1; i >= 0; i--) {\n\t\t\t\t\twidget.options[i] = null;\n\t\t\t\t}\n\t\t\t\tfor (let key in result['select_schueler']){\n\t\t\t\t\tlet opt = document.createElement(\"option\");\n\t\t\t\t\topt.value = key;\n\t\t\t\t\topt.text = result['select_schueler'][key];\n\t\t\t\t\twidget.options.add(opt);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdelete(result['select_schueler']);\n\n\t\t\tinstance.schuelerViewUpdate(instance, result);\n\n\t\t\t/*for (var key in result){\n\t\t\t\tif(key == 'details_noten'){\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tvar widgetItem = document.getElementById('schulmanager-schuelerview_' + key);\n\t\t\t\t\tif (widgetItem) {\n\t\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}*/\n\n\t\t\t//egw.loading_prompt('schulmanager',false);\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * select students for a new class changed, reload list\n\t */\n\tonSchuelerViewSchuelerChanged(_action, _senders) {\n\t\tlet instance = this;\n\t\t//var egw = this.egw;\n\t\t//this.egw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\n\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_ui.ajax_schuelerViewSchuelerChanged';\n\t\tlet schueler_id = _action.value;\n\n\t\tthis.egw.json(func, [schueler_id], function (result) {\n\t\t\t/*\n\t\t\tvar sla_nm = <et2_nextmatch>et2.getWidgetById('sla_nm');\n\t\t\tvar sko_nm = <et2_nextmatch>et2.getWidgetById('sko_nm');\n\t\t\tsla_nm.applyFilters('');\n\t\t\tsko_nm.applyFilters('');\n\t\t\t*/\n\t\t\tlet not_nm = <et2_nextmatch>et2.getWidgetById('not_nm');\n\t\t\tnot_nm.applyFilters();\n\n\t\t\tinstance.schuelerViewUpdate(instance, result);\n\t\t\t//egw.loading_prompt('schulmanager',false);\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * updates nested content\n\t * @param instance\n\t * @param result\n\t */\n\tschuelerViewUpdate(instance, result){\n\t\t// ############### new version\n\t\tinstance.tableUpdate(\"schulmanager-schuelerview_grid-sla\", result['sla_nm_rows']);\n\t\tinstance.tableUpdate(\"schulmanager-schuelerview_grid-sko\", result['sko_nm_rows']);\n\t\tinstance.tableUpdate(\"schulmanager-schuelerview_grid-san\", result['san_nm_rows']);\n\t\t//instance.tableUpdate(\"schulmanager-schuelerview_grid-noten\", result['noten_nm_rows']);\n\t\t// ##############################\n\n\t\tfor (let key in result){\n\t\t\tif(key != 'sla_nm_rows' && key != 'sko_nm_rows' && key != 'san_nm_rows'){\n\t\t\t\tlet widgetItem = document.getElementById('schulmanager-schuelerview_' + key);\n\t\t\t\tif (widgetItem) {\n\t\t\t\t\twidgetItem.innerText = result[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * appends a new row\n\t * @param id\n\t * @param row\n\t */\n\ttableUpdate(id, rows){\n\t\tlet table = <HTMLTableElement>document.getElementById(id);\n\n\t\t// delete rows\n\t\twhile(table.rows.length > 1) {\n\t\t\ttable.deleteRow(1);\n\t\t}\n\n\t\t// add new rows\n\t\tif(table){\n\t\t\tfor (let r = 0; r < rows.length; r++) {\n\t\t\t\tlet newRow = table.insertRow(table.rows.length);\n\t\t\t\tlet rowData = rows[r];\n\t\t\t\tfor (let i = 0; i < rowData.length; i++) {\n\t\t\t\t\tlet cell = newRow.insertCell(i);\n\t\t\t\t\tcell.innerHTML = rowData[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/**\n\t * Serach accounts to map them to teachers\n\t */\n\tonTeacherAutoLinking(_action, _senders) {\n\t\tlet et2 = this.et2;\n\t\tlet func = 'schulmanager.schulmanager_substitution_ui.ajax_onTeacherAutoLinking';\n\n\t\tthis.egw.json(func, [], function (result) {\n\t\t\tlet nm = <et2_nextmatch>et2.getWidgetById('nm');\n\t\t\tnm.applyFilters();\n\t\t}).sendRequest(true);\n\n\t}\n\n\t/**\n\t * Before linking teacher tom egw account\n\t * @param _action\n\t * @param _senders\n\t */\n\tonTeacherAccountLinkEdit(_action, _senders)\n\t{\n\t\tlet row_id = _senders[0]._index;\n\n\t\tlet func = 'schulmanager.schulmanager_substitution_ui.ajax_onTeacherAccountLinkEdit';\n\n\t\tthis.egw.json(func, [row_id], function (result) {\n\t\t\tlet modal = document.getElementById(\"schulmanager-accounts_editcontentmodal\");\n\t\t\tmodal.style.display = \"block\";\n\n\t\t\tdelete(result['link_account_id']);\n\n\t\t\tfor (let key in result){\n\t\t\t\tlet widget_id = 'schulmanager-accounts_' + key;\n\t\t\t\tlet widget = <HTMLInputElement>document.getElementById(widget_id);\n\t\t\t\tif (widget) {\n\t\t\t\t\twidget.innerText = result[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}).sendRequest(true);\n\t}\n\n\t/**\n\t * Commit teacher-account-link\n\t * @param _action\n\t * @param _senders\n\t */\n\tonTeacherAccountLinkCommit(_action, _senders)\n\t{\n\t\tlet modal = document.getElementById(\"schulmanager-accounts_editcontentmodal\");\n\t\tmodal.style.display = \"none\";\n\n\t\tlet et2 = this.et2;\n\t\tlet selAccount = <HTMLSelectElement>document.getElementById('schulmanager-accounts_account_id');\n\t\tlet account = selAccount.value;\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-accounts_token');\n\t\tlet token = tokenDiv.value;\n\n\t\tlet func = 'schulmanager.schulmanager_substitution_ui.ajax_onTeacherAccountLinkCommit';\n\n\t\tthis.egw.json(func, [account, token], function (result) {\n\t\t\tlet nm = <et2_nextmatch>et2.getWidgetById('nm');\n\t\t\tnm.refresh(result['row_index'], et2_nextmatch.UPDATE);\n\t\t}).sendRequest(true);\n\n\t}\n\n\t/**\n\t * Reset single row, delete teacher-account-link\n\t * @param _action\n\t * @param _senders\n\t */\n\tonTeacherAccountLinkReset(_action, _senders)\n\t{\n\t\tlet et2 = this.et2;\n\n\t\tlet row_ids = [];\n\t\tfor (let i = 0; i < _senders.length; i++) {\n\t\t\trow_ids.push(_senders[i]._index);\n\t\t}\n\n\t\t//var row_id = _senders[0]._index;\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-accounts_token');\n\t\tlet token = tokenDiv.value;\n\t\tlet func = 'schulmanager.schulmanager_substitution_ui.ajax_onTeacherAccountLinkReset';\n\n\t\tthis.egw.json(func, [row_ids, token], function (result) {\n\t\t\tlet nm = <et2_nextmatch>et2.getWidgetById('nm');\n\t\t\t//nm.refresh(result['row_id'], et2_nextmatch.UPDATE);\n\t\t\tnm.applyFilters();\n\t\t}).sendRequest(true);\n\t}\n\n\tdelLnwPerA(){\n\t\tlet et2 = this.et2;\n\t\tlet egw = this.egw;\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-schuelerview_token');\n\t\tlet token = tokenDiv.value;\n\t\tet2_dialog.show_dialog(function(button_id,value)\n\t\t{\n\t\t\tif (button_id == et2_dialog.OK_BUTTON)\n\t\t\t{\n\t\t\t\tegw.loading_prompt('schulmanager',true,egw.lang('please wait...'));\n\t\t\t\tlet func = 'schulmanager.schulmanager_ui.ajax_delLnwPerA';\n\t\t\t\tegw.json(func, [token], function (result) {\n\t\t\t\t\tlet not_nm = <et2_nextmatch>et2.getWidgetById('not_nm');\n\t\t\t\t\tnot_nm.applyFilters();\n\t\t\t\t}).sendRequest(true);\n\t\t\t\tegw.loading_prompt('schulmanager',false);\n\t\t\t}\n\n\t\t}, egw.lang('Confirmation required'), egw.lang('Confirmation required'), {}, et2_dialog.BUTTONS_OK_CANCEL, et2_dialog.QUESTION_MESSAGE);\n\t}\n\n\tdelLnwPerB(){\n\t\tlet et2 = this.et2;\n\t\tlet egw = this.egw;\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-schuelerview_token');\n\t\tlet token = tokenDiv.value;\n\t\tet2_dialog.show_dialog(function(button_id,value)\n\t\t{\n\t\t\tif (button_id == et2_dialog.OK_BUTTON)\n\t\t\t{\n\t\t\t\tlet func = 'schulmanager.schulmanager_ui.ajax_delLnwPerB';\n\t\t\t\tegw.json(func, [token], function (result) {\n\t\t\t\t}).sendRequest(true);\n\t\t\t}\n\t\t\tlet not_nm = <et2_nextmatch>et2.getWidgetById('not_nm');\n\t\t\tnot_nm.applyFilters();\n\t\t}, egw.lang('Confirmation required'), egw.lang('Confirmation required'), {}, et2_dialog.BUTTONS_OK_CANCEL, et2_dialog.QUESTION_MESSAGE);\n\t\t//var modal = document.getElementById(\"schulmanager-notenmanager-notendetails_editcontentmodal\");\n\t\t//modal.style.display = \"none\";\n\t}\n\n\tresetAllGrades(){\n\t\tlet et2 = this.et2;\n\t\tlet tokenDiv = <HTMLInputElement> document.getElementById('schulmanager-mntc_token');\n\t\tlet token = tokenDiv.value;\n\n\t\tet2_dialog.show_prompt(function(button_id, value){\n\t\t\tif (button_id == et2_dialog.OK_BUTTON)\n\t\t\t{\n\t\t\t\tlet func = 'schulmanager.schulmanager_mntc_ui.ajax_resetAllGrades';\n\t\t\t\tegw.json(func, [token, value], function (result) {\n\t\t\t\t\tif(result.error_msg){\n\t\t\t\t\t\tegw(window).message(result.error_msg, 'error');\n\t\t\t\t\t}\n\t\t\t\t\tegw(window).message(result.msg, 'success');\n\t\t\t\t}).sendRequest(true);\n\t\t\t}\n\t\t}, egw.lang('Confirmation required'), egw.lang('Absolut sicher, dass alle Noten gel√∂scht werden sollen?'), {}, et2_dialog.BUTTONS_OK_CANCEL, et2_dialog.QUESTION_MESSAGE);\n\t}\n}\n\napp.classes.schulmanager = SchulmanagerApp;\n\n\n\n"],"names":["SchulmanagerApp","EgwApp","appname","constructor","et2_ready","et2","name","header_change","cal_header_change","cal_hide_items","onSchuelerViewKlasseChanged","func","query","egw","json","totals","key","widget","getWidgetById","set_value","sendRequest","exportpdf_nb","_id","_widget","loading_prompt","lang","$a","jQuery","document","createElement","appendTo","hide","url","window","webserverUrl","prop","click","remove","exportpdf_kv","id","params","modal","getElementById","style","display","exportpdf_nbericht_prepare","result","length","options","i","opt","value","text","add","exportpdf_nbericht","showReturn","checked","showSigned","signerWidget","signerid","exportpdf_calm","getDOMNode","childNodes","innerHTML","parentNode","classList","css","cal_focus_item","_action","_send","blur","calEditMultiple","calDeleteEvent","refresh","nm","etemplate2","getById","widgetContainer","add_list_event","prefix","type_id","concat","fach_id","user_id","type","fach","user","calShowAddEvent","action","selected","nmEditGew","changeNote","_senders","tokenDiv","inputinfo_date","firstChild","inputinfo_type","inputinfo_desc","noteKey","noteVal","token","note_date","note_type","note_desc","addClass","alert","cssAvgKey","removeClass","changeGew","senders","gewKey","gewVal","changeGewAllModified","cssAltBKey","widgetAltB","subs_TeacherChanged","teacher_id","onDetailsNote","instance","stud_id","_index","updateDetailsNoten","widget_id","innerText","onContactData","tableUpdate","onDetailsKlasseChanged","klasse_id","widgetItem","onDetailsSchuelerChanged","schueler_id","id_prefix","block","sIndex","index","parseInt","col","widget_col_id","widget_col","onDetailsNotenEdit","idPostfix","substring","isGlnw","widgetNote","note_input","widgetTypeGKlnw","selTypeGlnw","selTypeKlnw","widgetDefDate","defDate_input","widgetDesc","desc_input","note_key","onDetailsNotenCommit","noteElement","typeFlagElement","typeFlag","selectedIndex","dateElement","descElement","tokenElement","noteKeyElement","onDetailsNotenCancel","onDetailsNotenDelete","action_id","et2_dialog","show_dialog","button_id","NO_BUTTON","BUTTONS_OK_CANCEL","QUESTION_MESSAGE","not_nm","applyFilters","schuelerViewUpdate","onSchuelerViewSchuelerChanged","rows","table","deleteRow","r","newRow","insertRow","rowData","cell","insertCell","onTeacherAutoLinking","onTeacherAccountLinkEdit","row_id","onTeacherAccountLinkCommit","selAccount","account","et2_nextmatch","UPDATE","onTeacherAccountLinkReset","row_ids","push","delLnwPerA","OK_BUTTON","delLnwPerB","resetAllGrades","show_prompt","error_msg","message","msg","app","classes","schulmanager"],"mappings":"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"}